# CNN 
* Convolution Neural Network
* 이미지 처리에 특화되어 있음

* 다층퍼셉트론에서 이미지 처리는 비효율적
---
* NEW Hidden Layer
* 합성곱 계층의 커널 활용, 풀링 계층(param x)
* 소수의 파라미터만을 집중 학습

- 만약 이미지가 들어오게 된다면 

1
* 엄청난 수의 픽셀
* 모든 위치의 마스크에 대한 이미지 파일이 필요

2
* 입력벡터 크기 증가
* 가중치 파라미터의 크기 증가

3
* 합성곱 계층의 커널 활용
* 풀링 계층의 활용

다층 퍼셉트론(완전연결계층) : 다층 퍼셉트론이 이미지를 골고루   
학습하려면 온갖 위치에 등장하는 이미지가 필요 (비 효율적)

# 순전파

# 합성곱 계층과 풀링 계층이란

## 합성곱 모델

입력픽셀 -> (반복적용) -> 합성곱 커널'가중치', 합성곱 커널'편향' -> 계산 및 출력 -> 출력픽셀 행렬

* 중심 위치는 계산할 출력 픽셀의 위치 이어야 함
* 커널의 반복이용 으로 커널에 대한 학습 횟수가 늘어나는 효과가 생겨서 학습이 빠르게 이뤄진다
* 같은 커널이 모든 위치에 적용되기 때문에 한 곳에서 포착된 패턴이 다른 곳에 이용될 수 있다

### padding(same) 방식의 합성곱 연산
* '0' 이라는 값으로 이미지를 확장해 둘러싸준다
* 입력 픽셀 크기와 출력 픽셀 크기의 값이 일정하다
* 일반적으로 더 많이 사용되는 방식이다

### valid 방식의 합성곱 연산
* 커널이 실제 입력 범위를 벗어나지 않을 때만 출력 픽셀을 생성
* 출력 이미지의 크기가 입력 이미지 보다 줄어들게 된다

### 건너뛰기 
* 합성곱 출력 생성 방식
* 이미지 크기를 줄여주기에 **처리 부담을 감소**
* 너무 많은 **정보를 무시**해버림

## 풀링 계층
* 대표값을 구하는것
* 최대치, 평균치 풀링 처리
  * 정보의 압축
  * 효율성이 높아짐
* 이미지 해상도를 줄이기 위해 적용
* 특징맵을 점점 작게 만드는 것
---
* 이미지 크기(image_size)
* 커널의 크기(kernel_size)
* 보폭(stride)
---
* 커널의 사이즈와 보폭이 다르면 효율성이 떨어진다
* 이미지 크기를 넘어간다면 padding(same)기법을 사용해 준다
* **이미지의 가로 세로가 보폭의 배수가 된다면 효과적이다**(짜투리가 없기 때문)
---
* 입력만으로 대표값을 구하는 과정(파라미터 필요없음)
  * 학습이 없다
* 합성곱 계층 사이에 배치되어 점점 작은 해상도의 특징맵에 정보가 집약되게 만드는데 이용
* 풀링 계층의 처리는 합성곱 계층이 넚은 영역의 정보를 대표값으로 대체하면서 처리
 
# 채널과 커널

* 각 채널이 특징을 잡아낸다

## 채널의 도입과 커널의 확장
* 필터 = 커널 : 입력 영역의 특정 패턴이나 특징에 민감하게 반응하는 경향으로 학습되는 경향
* 합성곱 계층의 입력 채널 수는 '최초의 이미지' 혹은 '이전 계층'이 생성한 '출력 채널 수'로  
  정해지지만, 출력 채널 수는 신경망 설계자가 자유롭게 정할 수 있음.
---
* 흑백이미지는 채널이 하나
* 컬러이미지는 채널이 세개
---
* Convolution -> Pooling -> Convolution -> Pooling -> Fully-connected
---
## 커널은 어떤 모양이 되어야 할까?

* 이미지의 작은 사각 영역에서 하나의 특징을 온전히 포착하려면 '커널'은 해당 영역의 모든 채널에 대한  
  입력 픽셀값을 볼 수 있어야 한다  
  즉, 하나의 특징을 포착하는 '커널'은 사각 영역입력의 모든 채널을 처리하는 3차원 가중치를 가져야 한다
* 출력 채널 수 만큼의 특징입을 만들어 내기 위해서는 커널이 출력 채널 수 만큼 있어야 한다
  '커널'은 입력 영역의 크리게 입력 채널과 출력 채널이 모두 반영된 4차원의 구도가 되어야 한다
* 2차원 해상도(h,w)에 채널(c)이 추가, 미니배치 단위의 학습 때문에 4차원 구도. 
  즉 합성곱 계층의 처리는 아래와 같다
  * 4차원 입력 - [미니배치의 크기, 입력 이미지 행수, 입력 이미지 열 수, 입력 채널 수]
    * 입력 행태[mb, xh, xw, xchn]
  * 4차원 커널 - [커널 행 수, 커널 열 수, 입력 채널 수, 출력 채널 수]
    * 커널 형태[kh, kw, xchn, ychn]
  * 4차원 입력 - [미니배치의 크기, 출력 이미지 행수, 출력 이미지 열 수, 출력 채널 수]
    * 출력 형태[mb, yh, yw, ychn]
      
* 풀링 층을 거쳐도 대개 이미지 해상도가 줄어들기만 할 뿐 채널 수는 변하지 않고 그대로 유지      
* feature map : polling을 했을때 나오는 map      
      
---
* 풀링 층을 거쳐도 해상도가 줄어들기만 할 뿐 채널 수는 변하지 않는다

# 역전파 
* 커널 가중치와 입력 픽셀은 서로가 서로의 계수로서 편미분값이 된다
* 출력 성분의 손실 기울기를 곱셈  
  입력 픽셀과 커널 가중치의 해당 출력 성분에 대한  
  '손실 기울기'를 구할 수 있음

